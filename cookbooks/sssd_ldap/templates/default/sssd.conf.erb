[sssd]
config_file_version = 2
services = nss, pam
domains = <%= node['sssd_ldap']['domain'] %>
debug_level = 3
reconnection_retries = 3
sbus_timeout = 30

[nss]
debug_level = 3
filter_groups = root
filter_users = root,ldap,named,avahi,haldaemon,dbus,radvd,tomcat,radiusd,news,mailman,nscd
reconnection_retries = 3
entry_cache_nowait_percentage = 50

[pam]
debug_level = 3
reconnection_retries = 3
offline_failed_login_attempts = 5
offline_failed_login_delay = 5

[domain/<%= node['sssd_ldap']['domain'] %>]
debug_level = 3
auth_provider = <%= node['sssd_ldap']['auth_provider'] %>
chpass_provider = <%= node['sssd_ldap']['chpass_provider'] %>
id_provider = <%= node['sssd_ldap']['id_provider'] %>
cache_credentials = <%= node['sssd_ldap']['cache_credentials'] %>
enumerate = <%= node['sssd_ldap']['enumerate'] %>

ldap_schema = <%= node['sssd_ldap']['ldap_schema'] %>
ldap_uri = <%= node['sssd_ldap']['ldap_uri'] %>

ldap_tls_reqcert = <%= node['sssd_ldap']['ldap_tls_reqcert'] %>
ldap_tls_cacertdir = <%= node['sssd_ldap']['ldap_tls_cacertdir'] %>
ldap_id_use_start_tls = <%= node['sssd_ldap']['ldap_id_use_start_tls'] %>

ldap_search_base = <%= node['sssd_ldap']['ldap_search_base'] %>
ldap_user_search_base = <%= node['sssd_ldap']['ldap_user_search_base'] %>
ldap_user_object_class = <%= node['sssd_ldap']['ldap_user_object_class'] %>
ldap_user_name = <%= node['sssd_ldap']['ldap_user_name'] %>
shell_fallback = <%= node['sssd_ldap']['shell_fallback'] %>

ldap_group_search_base = <%= node['sssd_ldap']['ldap_group_search_base'] %>
ldap_group_object_class = <%= node['sssd_ldap']['ldap_group_object_class'] %>

<% if node['sssd_ldap']['ldap_default_bind_dn'] %>ldap_default_bind_dn = <%= node['sssd_ldap']['ldap_default_bind_dn'] %><% end %>
<% if node['sssd_ldap']['ldap_default_authtok'] %>ldap_default_authtok = <%= node['sssd_ldap']['ldap_default_authtok'] %><% end %>

<% if node['sssd_ldap']['ldap_access_filter'] %>
access_provider = <%= node['sssd_ldap']['access_provider'] %>
ldap_access_filter = <%= node['sssd_ldap']['ldap_access_filter'] %>
<% end %>

